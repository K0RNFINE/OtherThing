<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="shortcut icon" href="ichika.png">
  <title>Choose Difficulty</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&display=swap" rel="stylesheet">
  <style>
    :root{
      --star-color: rgba(0, 255, 255, 0.2);
      --neon-blue: #00ffff;
      --neon-pink: #ff00ff;
    }
    *{box-sizing:border-box;}

    body{
      margin:0;
      font-family:'Orbitron',sans-serif;
      min-height:100vh;
      overflow:hidden;
      display:flex;
      justify-content:center;
      align-items:center;
      position:relative;
      background:#000;
    }

    /* Background video */
    #background-video{
      position:fixed;
      top:0;left:0;
      width:100%;height:100%;
      object-fit:cover;
      z-index:-2;
    }
    body::before{
      content:'';
      position:absolute;inset:0;
      background:rgba(0,0,0,.4);
      z-index:-1;
    }

    /* Stars (do not capture clicks) */
    .stars{
      position:absolute;inset:0;
      overflow:hidden;
      z-index:0;
      pointer-events:none;
    }
    .star{
      position:absolute;
      width:2px;height:100px;
      background:linear-gradient(transparent,var(--star-color));
      animation:shoot 3s linear infinite;
      opacity:.6;
    }
    @keyframes shoot{
      0%{transform:translateX(0) translateY(0) rotate(45deg);opacity:0;}
      10%{opacity:1;}
      100%{transform:translateX(-1000px) translateY(1000px) rotate(45deg);opacity:0;}
    }

    /* Main card */
    .container{
      position:relative;
      z-index:1;
      text-align:center;
      padding:32px 28px;
      background:rgba(255,255,255,0.05);
      border-radius:20px;
      backdrop-filter:blur(15px);
      border:1px solid rgba(255,255,255,0.12);
      box-shadow:0 0 30px rgba(0,255,255,0.2);
      width:min(900px,92vw);
    }
    h1{
      margin:0 0 22px;
      color:#fff;
      font-size:clamp(22px,4vw,36px);
    }

    /* Buttons layout */
    .button-group{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:18px;
      margin:0 auto 16px;
      max-width:100%;
    }
    .second-row{
      display:flex;
      flex-wrap:wrap;
      justify-content:center;
      gap:16px;
      margin-top:18px;
    }

    .difficulty-btn,.typing-challenge-btn,.rules-btn{
      padding:16px 28px;
      font-size:1.05em;
      border:2px solid #fff;
      border-radius:18px;
      background:transparent;
      color:#fff;
      cursor:pointer;
      position:relative;
      z-index:1;
      box-shadow:0 0 15px rgba(255,255,255,0.25);
      transition:transform .25s, box-shadow .35s, background .25s, border-color .25s;
      backdrop-filter:blur(5px);
      text-decoration:none;
      min-width:160px;
    }
    .difficulty-btn:hover,.typing-challenge-btn:hover,.rules-btn:hover{
      transform:translateY(-6px) scale(1.03) rotateX(4deg);
      box-shadow:0 0 30px rgba(0,255,255,0.6);
      background:rgba(255,255,255,0.08);
    }
    .easy{border-color:#4caf50; box-shadow:0 0 15px #4caf50;}
    .normal{border-color:#2196f3; box-shadow:0 0 15px #2196f3;}
    .hard{border-color:#f44336; box-shadow:0 0 15px #f44336;}
    .typing-challenge-btn{border-color:#9c27b0; box-shadow:0 0 15px #9c27b0;}
    .rules-btn{border-color:orange; box-shadow:0 0 15px orange;}

    /* Popup */
    .popup-overlay{
      position:fixed; inset:0;
      background:rgba(0,0,0,0.85);
      display:flex;
      justify-content:center;
      align-items:center;
      z-index:9999;
    }
    .popup-box{
      background:#0d0d0d;
      padding:32px 28px;
      text-align:center;
      border-radius:12px;
      box-shadow:0 0 25px rgba(0,255,255,0.4);
      color:#fff;
      width:min(520px,92vw);
    }
    .popup-box h2{margin:0 0 10px;}
    #startButton{
      padding:12px 30px;
      font-size:1.05em;
      border:2px solid var(--neon-blue);
      border-radius:10px;
      background:transparent;
      color:var(--neon-blue);
      cursor:pointer;
      box-shadow:0 0 10px var(--neon-blue);
      transition:all .25s ease-in-out;
      margin-top:12px;
    }
    #startButton:hover{background:var(--neon-blue); color:#000; box-shadow:0 0 25px var(--neon-blue);}
    .hidden{display:none !important;}

    /* Floating controls */
    #muteBtn{
      position:fixed; top:16px; right:16px; z-index:50;
      padding:10px 14px; font-size:16px;
      border:none; border-radius:8px;
      background:rgba(0,0,0,0.6); color:#fff; cursor:pointer;
      box-shadow:0 0 8px rgba(0,0,0,0.4);
    }
    #countdown{
      position:fixed; bottom:18px; left:50%; transform:translateX(-50%);
      font-size:1.1em; color:#fff; text-shadow:0 0 10px #ff0000;
      font-family:'Orbitron',sans-serif; z-index:50;
      background:rgba(0,0,0,0.4); padding:10px 16px; border-radius:10px;
      backdrop-filter:blur(5px);
    }

    @media (max-width:520px){
      .difficulty-btn,.typing-challenge-btn,.rules-btn{min-width:120px; padding:14px 18px;}
    }
  </style>
</head>
<body>

  <video id="background-video" muted playsinline loop preload="auto">
    <source src="SToRY.mp4" type="video/mp4">
  </video>

  <div class="stars" id="stars-container"></div>

  <div id="popup" class="popup-overlay">
    <div class="popup-box">
      <h2>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ô‡∏∞‡∏ô‡πâ‡∏≠‡∏á</h2>
      <p>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠</p>
      <button id="startButton">Start</button>
    </div>
  </div>

  <button id="muteBtn" disabled>üîá Mute</button>
  <div id="countdown">Loading...</div>

  <main id="mainContent" class="container" aria-live="polite">
    <h1>Select Difficulty</h1>
    <div class="button-group">
      <button class="difficulty-btn easy"   data-level="easy">Easy</button>
      <button class="difficulty-btn normal" data-level="normal">Normal</button>
      <button class="difficulty-btn hard"   data-level="hard">Hard</button>
    </div>
    <div class="second-row">
      <a href="https://k0rnfine.github.io/OtherThing/typing" class="typing-challenge-btn">Typing Challenge</a>
      <a href="https://k0rnfine.github.io/OtherThing/Rule" class="rules-btn">Rules</a>
    </div>
  </main>

  <script>
    const bgVideo   = document.getElementById('background-video');
    const popup     = document.getElementById('popup');
    const startBtn  = document.getElementById('startButton');
    const muteBtn   = document.getElementById('muteBtn');
    const container = document.getElementById('stars-container');

    // Create stars (non-blocking layer)
    for(let i=0;i<25;i++){
      const star=document.createElement('div');
      star.className='star';
      star.style.left = (Math.random()*100) + 'vw';
      star.style.top  = (Math.random()*30)  + 'vh';
      star.style.animationDelay   = (Math.random()*5) + 's';
      star.style.animationDuration= (2+Math.random()*2) + 's';
      container.appendChild(star);
    }

    // Difficulty click (event delegation keeps layout tidy)
    document.addEventListener('click', (e)=>{
      const btn = e.target.closest('.difficulty-btn');
      if(!btn) return;
      const level = btn.dataset.level;
      if(level==='easy'){
        location.href='https://k0rnfine.github.io/OtherThing/4button';
      }else if(level==='normal'){
        location.href='https://k0rnfine.github.io/OtherThing/';
      }else if(level==='hard'){
        location.href='https://k0rnfine.github.io/Saint_joseph/';
      }
    });

    // Start flow: play muted first (policy-friendly), then enable mute toggle and hide popup
    startBtn.addEventListener('click', async ()=>{
      try{
        bgVideo.muted = true;           // ensure first play is muted
        await bgVideo.play();           // user gesture ‚Üí should succeed
        popup.classList.add('hidden');  // ‚Üê reliably removes the overlay
        muteBtn.disabled = false;       // allow toggling audio
      }catch(err){
        console.warn('Playback blocked:', err);
      }
    });

    // Mute/unmute after playback started
    muteBtn.addEventListener('click', ()=>{
      bgVideo.muted = !bgVideo.muted;
      muteBtn.textContent = bgVideo.muted ? 'üîä Unmute' : 'üîá Mute';
    });

    // Diagnostics (optional)
    bgVideo.addEventListener('canplay', ()=>console.log('Video can play'));
    bgVideo.addEventListener('playing', ()=>console.log('Video is playing'));
    bgVideo.addEventListener('error', ()=>console.warn('Video error code:', bgVideo.error && bgVideo.error.code));

    // Countdown
    const countdownElement = document.getElementById('countdown');
    const targetDate = new Date('2050-06-05T00:00:00').getTime();
    function updateCountdown(){
      const now = Date.now();
      const distance = targetDate - now;
      if(distance<=0){
        countdownElement.innerText = '‚è∞ Timer Reached ‚Äî Thanks for playing!';
        document.getElementById('mainContent').classList.add('hidden');
        return;
      }
      const d = Math.floor(distance / (1000*60*60*24));
      const h = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
      const m = Math.floor((distance%(1000*60*60))/(1000*60));
      const s = Math.floor((distance%(1000*60))/1000);
      countdownElement.innerText = `Time Left: ${d}d ${h}h ${m}m ${s}s`;
    }
    setInterval(updateCountdown,1000); updateCountdown();
  </script>

</body>
</html>
